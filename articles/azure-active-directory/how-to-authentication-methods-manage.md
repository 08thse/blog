---
title: MFA と SSPR を新しい認証方法ポリシーに移行する方法
date: 2023-05-02 00:00
tags:
  - Azure AD
  - MFA
  - SSPR
toc:
  enabled: true
  min_depth: 1
  max_depth: 3
  list_number: false
---

# MFA と SSPR を新しい認証方法ポリシーに移行する方法

## はじめに

こんにちは、Azure & Identity サポート チームの田辺です。

今回は、Azure AD における認証方法ポリシーの移行方法についてご紹介します。これまで MFA (Multi-Factor Authentication) と SSPR (Self Service Password Reset) で利用可能な認証方法はそれぞれ別の画面で別々に管理されていました。現在これら別々の管理画面はレガシーな管理方法として扱われており、今後、この 2 種類のレガシ ポリシーを統一した、新しい認証方法ポリシーにて一元管理することが必要となっています。

レガシーな MFA と SSPR 用のポリシーは **2024 年 9 月 30 日** に非推奨となり、この期日までに新しい認証方法ポリシーに移行いただく必要がございます。適切に移行いただければ、現在と動作に変わりはなく、また今後よりきめ細かい制御も可能となります。

レガシ MFA と SSPR のポリシーの確認方法および新しい認証方法ポリシーへの移行方法につきましては、以下の公開情報にまとめられておりますのでご覧ください。

MFA と SSPR のポリシー設定を Azure AD の認証方法ポリシーに移行する方法
<https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/how-to-authentication-methods-manage>

本ブログ記事では、上記の公開情報で案内されている認証方法ポリシーの移行方法と、よくあるご質問について情報をおまとめいたしました。9 月が近づきますと、移行が差し迫り混乱が予想されますので、可能な限り速やかに下記対応を実施することをお勧めいたします。

なお、移行作業自体は数十分から 1 時間程度で完了することが一般的です。移行中にダウンタイムが生じることはありませんし、適切に構成いただければ、基本的にユーザー影響が生じることもありません。万が一、予期せぬ動作が生じた際には設定を切り戻すことも可能です。

## 1. 開始する前の確認事項

はじめに、お客様のテナントにおける各レガシー ポリシーの設定をご確認いただきたく存じます。

### レガシー MFA ポリシーの設定の確認

MFA で利用可能な認証方法の設定について確認します。

1. [Azure Portal] > [Azure Active Directory] > [ユーザー] > [ユーザーごとの MFA] に移動します。

   ![](how-to-authentication-methods-manage/legacy-mfa-01.png)  

2. [サービス設定] に移動します。

   ![](how-to-authentication-methods-manage/legacy-mfa-02.png)

3. [検証オプション] 項目からどの項目にチェックが入っているかを確認します。これがレガシ MFA ポリシーの設定です。

   ![](how-to-authentication-methods-manage/legacy-mfa-03.png)

上記のスクリーンショットでは、ユーザーが利用可能な MFA の方法として、4 つがチェックされていることがわかります。これは、ユーザが MFA を要求された際に、これらいずれかの方法を利用して (登録済みであれば) 認証を行えるということを意味します。

※ Azure AD Premium ライセンスを保有されている場合は、 [Azure Active Directory] > [セキュリティ] > [多要素認証] > [クラウドベースの多要素認証の追加設定] でも遷移可能です。

### レガシ SSPR ポリシーの設定の確認

SSPR で利用可能な認証方法の設定について確認します。

1. [Azure Active Directory] > [パスワード リセット] > [認証方法] に移動します。
2. 以下の [ユーザーが使用できる方法] でどの項目にチェックが入っているかを確認します。これがレガシ SSPR ポリシーの設定です。

   ![](how-to-authentication-methods-manage/legacy-sspr-01.png)

### 新しい認証方法ポリシーの確認

新しい認証方法ポリシーについては、以下の手順にてご確認いただけます。

1. [Azure Active Directory] > [セキュリティ] > [認証方法] > [ポリシー] に移動します。
2. 本項目が、新しい認証方法ポリシーの設定です。

   ![](how-to-authentication-methods-manage/new-01.png)

## 2. 移行を開始する

上記手順で、現在のレガシー ポリシーの設定を控えたら、移行を開始します。

移行のプロセスについては [移行の管理] という項目で管理します。[移行前] から [移行が進行中] に変更して移行を進め、 最終的には [移行が完了済み] に変更いただく必要がございます。移行の管理については、以下の手順でご確認ください。

### 移行の管理の確認

1. [Azure Active Directory] > [セキュリティ] > [認証方法] > [ポリシー] に移動します。
1. [移行の管理] を選択します。

   ![](how-to-authentication-methods-manage/new-02.png)
1. 画面右に表示される本項目が、[移行の管理] の設定です。

↑この画像は初期状態の画像ではないので、初期状態のものに差し替えるのが良いと思います。画面を初めて開いたお客様が、うちと画面が違うってびっくりすると思います。

   ![](how-to-authentication-methods-manage/new-03.png)

移行中にどのポリシーの設定が参照されるかついては、[移行の管理] 項目の設定状況に依存します。
各オプションで参照されるポリシーについて、ご案内いたします。

### 移行の管理の項目について

|移行の管理の各オプション | 種類 |参照されるポリシー|
|---|--- |---|
|移行前 |MFA |認証方法ポリシーとレガシ MFA ポリシー|
|^  | SSPR| レガシ SSPR ポリシーのみ|
|移行が進行中 | MFA | 認証方法ポリシーとレガシ MFA ポリシー|
| ^  | SSPR| 認証方法ポリシーとレガシ SSPR ポリシー|
|移行が完了済み | MFA | 認証方法ポリシーのみ|
| ^  | SSPR| 認証方法ポリシーのみ|

### 移行の作業について

認証方法の具体的な移行作業としては、移行の管理にて [移行が進行中] を選択し、レガシ ポリシーの設定内容を認証方法ポリシーにも設定します。
まずは 1 で確認したレガシ ポリシーの設定内容を確認し、対応する認証方法ポリシーを有効に更新します。

#### レガシ MFA ポリシーに対応する認証方法ポリシー

レガシ MFA ポリシー | 認証方法ポリシー
---|---
電話の呼び出し | 音声通話
電話へのテキスト | メッセージ SMS
モバイル アプリでの通知 | Microsoft Authenticator
モバイル アプリからの確認コードまたはハードウェア トークン | サード パーティ製のソフトウェア OATH トークン <br> ハードウェア OATH トークン (まだ使用できません) <br> Microsoft Authenticator

#### レガシ SSPR ポリシーに対応する認証方法ポリシー

レガシ SSPR ポリシー | 認証方法ポリシー
---|---
モバイル アプリの通知 | Microsoft Authenticator
モバイル アプリ コード | Microsoft Authenticator <br> サード パーティ製のソフトウェア OATH トークン
Email  | 電子メールの OTP
携帯電話  | 音声通話 <br> SMS
会社電話  |  音声通話
秘密の質問 |  まだ使用できません (※)

※秘密の質問については 2023 年 5 月 時点で認証方法ポリシーで管理できないため、レガシ SSPR ポリシーを使い続けてください。

## 3. 移行を完了する

[移行が進行中] の状態にて、ご要望の認証方法が使用可能となるよう新しい認証方法ポリシーを設定できたら、レガシ MFA 、 SSPR ポリシーを無効にし、テナントにてご要望の認証方法が MFA と SSPR の双方で利用可能かご確認ください。
テストが完了したら、[移行が完了済み] に変更します。
なお、テナント上にてレガシ ポリシーが有効な場合には [移行が完了済み] に変更することは出来ません。
[移行が完了済み] に変更した場合、レガシ ポリシーについては以下のような表示となり、新しい認証方法ポリシーによって管理されていることが明記されます。
ご参考 : [移行が完了済み] に移行後のレガシ MFA ポリシー ([検証オプション])

![](how-to-authentication-methods-manage/legacy-mfa-finish.png)

ご参考 : [移行が完了済み] に移行後のレガシ SSPR ポリシー  ([パスワード リセット] > [認証方法])

![](how-to-authentication-methods-manage/legacy-sspr-finish.png)

## 参考情報

認証方法ポリシーについては、以下の公開情報でもご案内しておりますので、ご参照ください。
Azure AD の認証方法を管理する
<https://learn.microsoft.com/ja-jp/azure/active-directory/authentication/concept-authentication-methods-manage>

## FAQ

***
Q1.
もし、2024 年 9 月 30 日 まで何もしなかった場合、どうなりますか。
A1.
認証方法ポリシーへの移行を実施しなかった場合、これまでユーザーが利用していた認証方法が利用できなくなる可能性がございます。
例えば、各ポリシーで以下の組み合わせの設定を行っていた場合、2024 年 9 月 30 日以降はレガシ MFA ポリシーが廃止されるため、ユーザーは SMS による認証方法を利用できなくなることが予想されます。

ポリシー | 設定
---|---
レガシ MFA ポリシー | SMS による認証方法を有効に設定
認証方法ポリシー | SMS による認証方法を無効に設定

このため、期日以降も SMS による認証方法をご利用されたい場合は、認証方法ポリシーで SMS を有効に設定いただく必要がございます。
***
Q2.
レガシ ポリシーへの切り戻しはできないでしょうか。
A2.
万が一、何らか予期しない動作が生じた場合は、レガシー ポリシーへ切り戻すことは可能です。この場合、一度「移行が完了済み」のステータスを以前のステータスに戻すこととなります。加えて、レガシーポリシー側に以前の状態を手動で復元 (チェックボックスをつけなおす) する作業が必要です。

一般的に、レガシーポリシーへの切り戻しを行うよりも、発生している問題に応じて、新しいポリシー側の設定を見直す方がより効果的です。弊社サポート部門でも支援が可能ですので、その際はぜひお問い合わせください。
***
Q3.
秘密の質問については近日公開予定ですが、それまでは、[移行が進行中] のままにしなければいけないのでしょうか。
A3.
いいえ、秘密の質問については、レガシ SSPR ポリシーで有効にしたままの状態で移行を完了できます。
だたし、秘密の質問を使用していて、それらを無効にしたくない場合は、新しい認証方法ポリシーにて秘密の質問が使用可能になるまで、レガシ SSPR ポリシーで有効なままにしておいてください。
なお、現状では、秘密の質問を認証方法の一つとして提供を続ける予定でございます。
しかし、米国政府が発行している ID 標準 (NIST Special Publication 800-63B) にて、ユーザー認証の方法として秘密の質問の利用が非推奨であることが挙げられます。
弊社ではお客様に選択肢を提供するという意味で秘密の質問を認証方法の一つとして提供を続けますが、秘密の質問はパスワードと同様に記憶に基づく認証方法であり、認証強度の低い方法です。
このため、秘密の質問ではなく、他の認証方法の利用も是非ご検討いただきたく存じます。
***
Q4.
レガシ ポリシーを確認しました。
以下の設定の場合、どの認証方法ポリシーを有効にしたらいいでしょうか？

- レガシ MFA ポリシー
- 電話へのテキスト メッセージ
- モバイル アプリによる通知
- モバイル アプリまたはハードウェア トークンからの確認コード
- レガシ SSPR ポリシー
  - モバイル アプリ コード
  - 電子メール
  - 携帯電話
A4.
レガシ ポリシー と認証方法ポリシーの対応表に従い、認証方法ポリシーにて、以下の認証方法を有効にします。
- 認証方法 ポリシー
  - Microsoft Authenticator
  - SMS 
  - サード パーティ製のソフトウェア OATH トークン
  - 音声通話
  - メール OTP 

***

上記内容が皆様の参考となりますと幸いです。
ご不明な点等がありましたら、ぜひ弊社サポート サービスをご利用ください。
